* INA139
*****************************************************************************
* (C) COPYRIGHT 2012 TEXAS INSTRUMENTS INCORPORATED. ALL RIGHTS RESERVED.
*****************************************************************************
** THIS MODEL IS DESIGNED AS AN AID FOR CUSTOMERS OF TEXAS INSTRUMENTS.
** TI AND ITS LICENSORS AND SUPPLIERS MAKE NO WARRANTIES, EITHER EXPRESSED
** OR IMPLIED, WITH RESPECT TO THIS MODEL, INCLUDING THE WARRANTIES OF
** MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  THE MODEL IS
** PROVIDED SOLELY ON AN "AS IS" BASIS.  THE ENTIRE RISK AS TO ITS QUALITY
** AND PERFORMANCE IS WITH THE CUSTOMER.
*****************************************************************************
*
* THIS MODEL IS SUBJECT TO CHANGE WITHOUT NOTICE. TEXAS INSTRUMENTS
* INCORPORATED IS NOT RESPONSIBLE FOR UPDATING THIS MODEL.
*
*****************************************************************************
*
** RELEASED BY: WEBENCH Design Center, Texas Instruments Inc.
* PART: INA139
* DATE: 26JUL2012
* MODEL TYPE: ALL IN ONE
* SIMULATOR: TINA
* SIMULATOR VERSION: 9.1.30.94 SF-TI
* EVM ORDER NUMBER: N/A
* EVM USERS GUIDE: N/A
* DATASHEET: SBOS181D – DECEMBER 2000 – REVISED NOVEMBER 2005
*
* MODEL VERSION: Final 1.0
*
*****************************************************************************
*
* UPDATES:
*
* VERSION 1.0 :
* RELEASE TO WEB
*
*****************************************************************************
*BEGIN MODEL INA139
*SIMULATED FEATURES:
*GAIN VS FREQUENCY
*INPUT COMMON MODE REJECTION WITH FREQUENCY
*POWER SUPPLY REJECTION WITH FREQUENCY
*OUTPUT CURRENT NOISE VS FREQUENCY
*OUTPUT VOLTAGE LIMITATION
*QUIESCENT CURRENT
*INPUT VOLTAGE OFFSET
*INPUT COMMON MODE RANGE
*OUTPUT CURRENT COMING THROUGH THE SUPPLY RAILS
*****************************************************************************
.SUBCKT INA139 IN+ IN- V+ GND OUT
Vos         +IN_CMRR_6 31 176.14U
V3          40 VCC_CLP_13 900M
V8          VEE_CLP_12 GND 100U
V7          24 40 100U
VAM4        45 Vp- ; Current Arrow
VAM3        46 Vp+ ; Current Arrow
VAM2        Vp+ 47 ; Current Arrow
VAM1        Vp- 48 ; Current Arrow
V12         49 GND 2.7
V9          50 GND 40
V1          51 GND 2.7
V2          52 GND 40
EVCVS5      17 GND 16 GND  1M
EVCVS4      19 GND 18 GND  1U
R1          GND 16 1 
GVCCS4      16 GND 19 GND  -1
C4          18 GND 145N 
R10         18 GND 1 
GVCCS2      18 GND 20 GND  -1
L1          21 20 176.81N  
R9          GND 21 R_RES_1 1 
GVCCS1      GND 20 22 GND  1MEG
R5          23 Ref 1 
XRnless     V+ 24 RNOISE_FREE_0_INA139
XRcon       25 25 RNOISE_FREE_1_INA139
XRcon_2     26 26 RNOISE_FREE_1_INA139
XRin1       GND -IN RNOISE_FREE_0_INA139
XRin1_2     28 +IN RNOISE_FREE_0_INA139
XRnless_2   GND 22 RNOISE_FREE_0_INA139
XIn11       OUT GND FEMT_0_INA139
EVCVS2      30 GND Vp- GND  1
EVCVS1      31 GND Vp+ GND  1
R18         32 CLAW_s2_33 -1G 
R17         CLAW_s1_34 32 -1G 
*** Rtemp addded to solve convergence in Topspice
Rtemp       32 GND 1G
XU25        PSRR GND 30 35 VCVS_LIMIT_0_INA139
XU11        36 GND GND PSRR RL VCCS_LIMIT_0_INA139
XU10        37 GND GND 36 RL VCCS_LIMIT_1_INA139
XU9         PSRR GND RL RNOISE_FREE_2_INA139
XU8         38 GND RL RNOISE_FREE_3_INA139
GVCCS5      37 GND V+ GND  -501.1N
C5          GND PSRR 1N 
L3          38 36 1.266M 
L2          39 37 3.1751M 
R15         GND 39 1 
C3          24 GND 1 
R6          VEE_CLP_12 GND 1G 
R4          VCC_CLP_13 GND 1G 
LCM         41 GND 1M  
XU7         41 42 RL RNOISE_FREE_4_INA139
XU6         43 GND GND 42 RL VCCS_LIMIT_2_INA139
EVCVS8      43 GND +IN_CMRR_6 0  1
EVCVSCM     35 44 42 GND  1.7783U
EVCVS3      28 GND +IN_CMRR_6 44  1
GVCCS3      Vout_s GND 17 GND  -1
R14         IN- Vp- 2K 
R13         IN+ Vp+ 2K 
XU4         51 46 IDEAL_D_0_INA139
XU1         49 45 IDEAL_D_0_INA139
XU2         48 50 IDEAL_D_0_INA139
XU5         47 52 IDEAL_D_0_INA139
C16         GND 25 1P  
C12         26 GND 1P  
R19         CLAW_s2_33 25 1 
R16         CLAW_s1_34 26 1 
R12         32 Vout_s 10M 
SW6         32 CLAW_s2_33 25 GND  S_VSWITCH_1
SW5         CLAW_s1_34 32 GND 26  S_VSWITCH_2
XU20        VEE_CLP_12 Vout_s CLAW_s2_33 GND VCVS_LIMIT_1_INA139
XU19        VCC_CLP_13 Vout_s CLAW_s1_34 GND VCVS_LIMIT_2_INA139
XU3         +IN -IN V+ Vout GND Ref RL OPA_0_INA139
C2          RL GND 1 
R3          54 RL 1G 
VCCVS1_in   Vout_s OUT
HCCVS1      Iout GND VCCVS1_in   1
XU22        OUT Iout 54 GND VCVS_LIMIT_3_INA139
C1          Vout_s GND 36.17P  
VCCCS1_in   Vout 23
FCCCS1      +IN 22 VCCCS1_in   50
.MODEL R_RES_1 RES ( TCE=0 T_ABS=-300)
.MODEL S_VSWITCH_1 VSWITCH (RON=1 ROFF=1G VON=10 VOFF=0)
.MODEL S_VSWITCH_2 VSWITCH (RON=1 ROFF=1G VON=10 VOFF=0)
.ENDS

.SUBCKT OPA_0_INA139 IN+ IN- VCC VOUT VEE GND_FLOAT RL
V3          92 VCC_CLP_84 100M
V2          95 96 2.6
V1          98 99 100M
V9          101 102 1
V12         104 105 100M
V8          VEE_CLP_83 VEE 50U
V7          VCC 92 100U
IS1         VCC VEE 60U
R6          GND_FLOAT Vsense 1 
XR107       88 Vzo_4 RNOISE_FREE_5_INA139
R5          90 AOL_p0z 1 
L1          GND_FLOAT 90 15.9134M  
XR107_2     AOL_Final GND_FLOAT RNOISE_FREE_6_INA139
XR107_3     CLAW_clamp GND_FLOAT RNOISE_FREE_6_INA139
R32         94 PATH+ 1 
EVCVS7      95 GND_FLOAT VCC GND_FLOAT  1
XU9         94 96 IDEAL_D_1_INA139
R17         PATH+ 97 1 
XU8         98 97 IDEAL_D_1_INA139
EVCVS5      99 GND_FLOAT VEE GND_FLOAT  1
R2          100 PATH- 1 
EVCVS6      101 GND_FLOAT VCC GND_FLOAT  1
XU2         100 102 IDEAL_D_1_INA139
R3          PATH- 103 1 
XU1         104 103 IDEAL_D_1_INA139
GVCCS13     GND_FLOAT CLAW_clamp AOL_p0zp1 GND_FLOAT  1M
GVCCS14     GND_FLOAT AOL_Final CLAW_clamp GND_FLOAT  1M
XR107_4     AOL_p0zp1 GND_FLOAT RNOISE_FREE_7_INA139
GVCCS10     GND_FLOAT AOL_p0zp1 AOL_p0z GND_FLOAT  1U
EVCVS2      105 GND_FLOAT VEE GND_FLOAT  1
R10         110 PATH- 1 
EVCVS1      110 GND_FLOAT 111 GND_FLOAT  1
R4          VEE_CLP_83 GND_FLOAT 1G 
R1          VCC_CLP_84 GND_FLOAT 1G 
C16         GND_FLOAT 112 1P  
C23         GND_FLOAT Vclp 1F  
C9          114 GND_FLOAT 10P  
R30         114 Vimon 10 
C12         115 GND_FLOAT 1P  
R29         88 Vclp 1 
R19         CLAW_s2_108 112 1 
R16         CLAW_s1_109 115 1 
R12         116 CLAW_clamp 10M 
R15         0 GND_FLOAT 1G 
GIsinking   VEE GND_FLOAT 117 GND_FLOAT  1M
GIsourcing  VCC GND_FLOAT 118 GND_FLOAT  1M
R23         117 GND_FLOAT 10K 
SW7         Vimon 117 114 GND_FLOAT  S_VSWITCH_1
R21         GND_FLOAT 118 10K 
SW8         Vimon 118 114 GND_FLOAT  S_VSWITCH_2
R22         119 PATH+ 1 
EVCVS4      119 GND_FLOAT +IN_CMRR_87 GND_FLOAT  1
SW6         116 CLAW_s2_108 112 GND_FLOAT  S_VSWITCH_3
SW5         CLAW_s1_109 116 GND_FLOAT 115  S_VSWITCH_4
XU26        PATH+ PATH- GND_FLOAT Vinpins VCCS_LIMIT_3_INA139
XU4         Vinpins GND_FLOAT GND_FLOAT AOL_p0 VCCS_LIMIT_4_INA139
XU20        VEE_CLP_83 VOUT CLAW_s2_108 GND_FLOAT VCVS_LIMIT_1_INA139
XU19        VCC_CLP_84 VOUT CLAW_s1_109 GND_FLOAT VCVS_LIMIT_2_INA139
R20         IN+ +IN_CMRR_87 1 
R18         IN- 111 1 
GVCCS6      GND_FLOAT AOL_p0z Vsense GND_FLOAT  1
XR102       120 121 RNOISE_FREE_7_INA139
XR101       122 120 RNOISE_FREE_7_INA139
C6          120 0 1  
XR104       AOL_p0 GND_FLOAT RNOISE_FREE_8_INA139
XR103       GND_FLOAT Vinpins RNOISE_FREE_7_INA139
EVCVS34     GND_FLOAT 0 120 0  1
EVCVS29     122 0 VCC 0  1
EVCVS28     121 0 VEE 0  1
VCCVS1_in   Vzo_4 VOUT
HCCVS1      Vimon GND_FLOAT VCCVS1_in   1K
GVCCS5      GND_FLOAT Vsense AOL_p0 GND_FLOAT  1
Ccc         AOL_p0 GND_FLOAT 497.294N  
EVCVS3      88 GND_FLOAT AOL_Final GND_FLOAT  1
.MODEL S_VSWITCH_1 VSWITCH (RON=1M ROFF=10MEG VON=-10M VOFF=0)
.MODEL S_VSWITCH_2 VSWITCH (RON=1M ROFF=10MEG VON=10M VOFF=0)
.MODEL S_VSWITCH_3 VSWITCH (RON=1 ROFF=1G VON=10 VOFF=-10)
.MODEL S_VSWITCH_4 VSWITCH (RON=1 ROFF=1G VON=10 VOFF=-10)
.ENDS

* NOISELESS RESISTOR
.SUBCKT RNOISE_FREE_0_INA139  1 2
*ROHMS = VALUE IN OHMS OF NOISELESS RESISTOR
.PARAM ROHMS=1K
ERES 1 3 VALUE = { I(VSENSE) * ROHMS }
RDUMMY 30 3 1
VSENSE 30 2 DC 0V
.ENDS 

* NOISELESS RESISTOR
.SUBCKT RNOISE_FREE_1_INA139  1 2
*ROHMS = VALUE IN OHMS OF NOISELESS RESISTOR
.PARAM ROHMS=1G
ERES 1 3 VALUE = { I(VSENSE) * ROHMS }
RDUMMY 30 3 1
VSENSE 30 2 DC 0V
.ENDS

* BEGIN PROG NSE FEMTO AMP/RT-HZ 
.SUBCKT FEMT_0_INA139  1 2
* BEGIN SETUP OF NOISE GEN - FEMPTOAMPS/RT-HZ
* INPUT THREE VARIABLES
* SET UP INSE 1/F
* FA/RHZ AT 1/F FREQ
.PARAM NLFF=8960
* FREQ FOR 1/F VAL
.PARAM FLWF=340
* SET UP INSE FB
* FA/RHZ FLATBAND
.PARAM NVRF=20000
* END USER INPUT
* START CALC VALS
.PARAM GLFF={PWR(FLWF,0.25)*NLFF/1164}
.PARAM RNVF={1.184*PWR(NVRF,2)}
.MODEL DVNF D KF={PWR(FLWF,0.5)/1E11} IS=1.0E-16
* END CALC VALS
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DVNF
D2 8 0 DVNF
E1 3 6 7 8 0
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNVF}
R5 5 0 {RNVF}
R6 3 4 1E9
R7 4 0 1E9
G1 1 2 3 4 1E-6
C1 1 0 1E-15
C2 2 0 1E-15
C3 1 2 1E-15
.ENDS
* END PROG NSE FEMTO AMP/RT-HZ

*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_0_INA139  VC+ VC- VOUT+ VOUT-        
.PARAM GAIN = -1
.PARAM VPOS = 20M
.PARAM VNEG = -20M
E1 VOUT+ VOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),VPOS,VNEG)}
.ENDS 

*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCCS_LIMIT_0_INA139  VC+ VC- IOUT+ IOUT- EXT
*       
G1 IOUT+ IOUT- VALUE={ V(VC+, VC-) / (  (-0.7U*V(EXT)*V(EXT)) + 0.2265455*V(EXT) -210.97901 ) }
.ENDS 

*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCCS_LIMIT_1_INA139  VC+ VC- IOUT+ IOUT- EXT    
G1 IOUT+ IOUT- VALUE={ V(VC+, VC-) / (  (-0.2U*V(EXT)*V(EXT)) +30.3461M*V(EXT) +286.10994 ) }
.ENDS

* NOISELESS RESISTOR
.SUBCKT RNOISE_FREE_2_INA139  1 2 EXT
*ROHMS = VALUE IN OHMS OF NOISELESS RESISTOR
.PARAM ROHMS=1E6
ERES 1 3 VALUE = { I(VSENSE) * (  (-0.7U*V(EXT)*V(EXT)) + 0.2265455*V(EXT) -210.97901 ) }
RDUMMY 30 3 1M
VSENSE 30 2 DC 0V
.ENDS

* NOISELESS RESISTOR
.SUBCKT RNOISE_FREE_3_INA139  1 2 EXT
*ROHMS = VALUE IN OHMS OF NOISELESS RESISTOR
.PARAM ROHMS=1E6
ERES 1 3 VALUE = { I(VSENSE) * (  (-0.2U*V(EXT)*V(EXT)) +30.3461M*V(EXT) +286.10994 ) }
RDUMMY 30 3 1M
VSENSE 30 2 DC 0V
.ENDS 

* NOISELESS RESISTOR
.SUBCKT RNOISE_FREE_4_INA139  1 2 EXT
*ROHMS = VALUE IN OHMS OF NOISELESS RESISTOR
.PARAM ROHMS=1E6
ERES 1 3 VALUE = { I(VSENSE) * (  (-1.556E-10*V(EXT)*V(EXT)) + 128.2U*V(EXT) - 92.7452M ) }
RDUMMY 30 3 1M
VSENSE 30 2 DC 0V
.ENDS

*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCCS_LIMIT_2_INA139  VC+ VC- IOUT+ IOUT- EXT
G1 IOUT+ IOUT- VALUE={ (V(VC+, VC-)) / (  (-1.556E-10*V(EXT)*V(EXT)) + 128.2U*V(EXT) - 92.7452M ) }
.ENDS 

*TG IDEAL DIODE
.SUBCKT IDEAL_D_0_INA139  A C
D1 A C DNOM
.MODEL DNOM D (IS=1E-15 RS=1E-3)
.ENDS 

*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_1_INA139  VC+ VC- VOUT+ VOUT-
.PARAM GAIN = 100
.PARAM VPOS = 5000
.PARAM VNEG = -5000
E1 VOUT+ VOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),VPOS,VNEG)}
.ENDS

*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_2_INA139  VC+ VC- VOUT+ VOUT-
.PARAM GAIN = 100
.PARAM VPOS = 5000
.PARAM VNEG = -5000
E1 VOUT+ VOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),VPOS,VNEG)}
.ENDS

*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_3_INA139  VC+ VC- VOUT+ VOUT-
E1 VOUT+ VOUT- VALUE={V(VC+)/(V(VC-)+1N)}
.ENDS 

* NOISELESS RESISTOR
.SUBCKT RNOISE_FREE_5_INA139  1 2
*ROHMS = VALUE IN OHMS OF NOISELESS RESISTOR
.PARAM ROHMS=100
ERES 1 3 VALUE = { I(VSENSE) * ROHMS }
RDUMMY 30 3 1
VSENSE 30 2 DC 0V
.ENDS 

* NOISELESS RESISTOR
.SUBCKT RNOISE_FREE_6_INA139  1 2
*ROHMS = VALUE IN OHMS OF NOISELESS RESISTOR
.PARAM ROHMS=1E3
ERES 1 3 VALUE = { I(VSENSE) * ROHMS }
RDUMMY 30 3 1
VSENSE 30 2 DC 0V
.ENDS 

*TG IDEAL DIODE
.SUBCKT IDEAL_D_1_INA139  A C
D1 A C DNOM
.MODEL DNOM D (TT=10P CJO=1E-18 IS=1E-15 RS=1E-3)
.ENDS 

* NOISELESS RESISTOR
.SUBCKT RNOISE_FREE_7_INA139  1 2
*ROHMS = VALUE IN OHMS OF NOISELESS RESISTOR
.PARAM ROHMS=1E6
ERES 1 3 VALUE = { I(VSENSE) * ROHMS }
RDUMMY 30 3 1
VSENSE 30 2 DC 0V
.ENDS 

*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCCS_LIMIT_3_INA139  VC+ VC- IOUT+ IOUT-
.PARAM GAIN = 100U
.PARAM IPOS = .5
.PARAM INEG = -.5
G1 IOUT+ IOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),IPOS,INEG)}
.ENDS 

*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCCS_LIMIT_4_INA139  VC+ VC- IOUT+ IOUT-
.PARAM GAIN = 2.3E-3
.PARAM IPOS = 0.165
.PARAM INEG = -0.165
G1 IOUT+ IOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),IPOS,INEG)}
.ENDS

* NOISELESS RESISTOR
.SUBCKT RNOISE_FREE_8_INA139  1 2
*ROHMS = VALUE IN OHMS OF NOISELESS RESISTOR
.PARAM ROHMS=32000
ERES 1 3 VALUE = { I(VSENSE) * ROHMS }
RDUMMY 30 3 1
VSENSE 30 2 DC 0V
.ENDS
*$